<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Password Analysis Report</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #1f1f1f;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.6);
        }

        nav {
            display: flex;
            justify-content: space-around;
            padding: 1rem;
        }

        nav a {
            color: #e0e0e0;
            text-decoration: none;
            font-weight: bold;
            padding: 0.5rem;
            transition: background-color 0.3s ease;
        }

        nav a:hover {
            background-color: #333;
            border-radius: 5px;
        }

        .content {
            padding: 100px 2rem 2rem 2rem;
            max-width: 1200px;
            margin: auto;
        }

        section {
            margin-bottom: 4rem;
        }

        h2 {
            color: #ffffff;
            border-bottom: 1px solid #333;
            padding-bottom: 0.4rem;
            margin-left: 1rem;
            margin-bottom: 1.5rem;
            font-size: 1.75rem;
        }

        .module {
            background-color: #1a1a1a;
            border: 1px solid #2c2c2c;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 0 12px rgba(0,0,0,0.3);
        }

        .module h3 {
            margin-top: 0;
            color: #ffffff;
            font-size: 1.2rem;
            border-bottom: 1px solid #333;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }

        .module-content {
            display: flex;
            flex-wrap: wrap;
            width: 100%;
        }

        .text {
            flex: 1 1 250px;
            padding: 2rem;
            flex-direction: column;
            justify-content: center;
            max-width: 45%;
        }

        .chart {
            flex: 1 1 250px;
            padding: 2rem;
            max-width: 45%;
        }

        .icon {
            float: left;
            margin-top: 4px;
            margin-right: 10px;
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            margin-top: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1.1rem;
            border: 1px solid #2c2c2c;
        }

        th {
            background-color: #242424;
            font-weight: bold;
        }

        td {
            background-color: #1e1e1e;
        }

        a.section-link {
            color: #00bcd4;
        }

        select {
            background-color: #2c2c2c;
            color: #e0e0e0;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 4px 8px;
        }

        #passwordTable_length {
            color: #e0e0e0;
            margin-left: 20px;
            margin-bottom: 20px;
        }

        #passwordTable_filter {
            color: #e0e0e0;
            margin-right: 20px;
            margin-bottom: 20px;
        }

        #passwordTable_filter input {
            color: #e0e0e0;
        }

        #passwordTable_info {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        #passwordTable_paginate {
            margin-right: 20px;
            margin-bottom: 20px;
        }

        #minLength, #maxLength, #minComplex, #maxComplex {
            width: 40px;
            border-radius: 4px;
        }

        #colvis {
            float: right;
            font-size: 1rem;
            margin-right: 20px;
        }

        div.dt-button-collection button.dt-button {
            color: #444 !important;
        }

        @media screen and (max-width: 768px) {
            nav {
                flex-direction: column;
                align-items: center;
            }
        }

        .disclaimer {
            background-color: #2c2c2c;
            color: #cccccc;
            border-left: 4px solid #f39c12;
            padding: 12px 16px;
            margin: 20px auto;
            max-width: 1200px;
            font-size: 0.95rem;
            line-height: 1.4;
            border-radius: 6px;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js"></script>
</head>
<body>
        <h2>Password Details<div id="colvis"><span id="colvis-container"></span></div></h2>
            <table id="passwordTable" class="display">
                <thead>
                    <tr>
                        <th>domain</th>
                        <th>account</th>
                        <th>hash</th>
                        <th>password</th>
                        <th>is_cracked
                            <select id="crackedFilter">
                                <option value="">All</option>
                                <option value="True">True</option>
                                <option value="False">False</option>
                            </select>
                        </th>
                        <th>length
                            <input type="number" id="minLength" placeholder="Min">
                            <input type="number" id="maxLength" placeholder="Max">
                        </th>
                        <th>complexity
                            <input type="number" id="minComplex" placeholder="Min">
                            <input type="number" id="maxComplex" placeholder="Max">
                        </th>
                        <th>is_admin
                            <select id="adminFilter">
                                <option value="">All</option>
                                <option value="True">True</option>
                                <option value="False">False</option>
                            </select>
                        </th>
                        <th>is_kerberoastable
                            <select id="kerbFilter">
                                <option value="">All</option>
                                <option value="True">True</option>
                                <option value="False">False</option>
                            </select>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for account in accounts %}
                    <tr>
                        <td>{{ account.domain }}</td>
                        <td>{{ account.username }}</td>
                        <td>{{ account.nt_hash }}</td>
                        <td>{% if account.plaintext == None %}-{% else %}{{ account.plaintext }}{% endif %}</td>
                        <td>{{ account.is_cracked }}</td>
                        <td>{% if account.length == None %}-{% else %}{{ account.length }}{% endif %}</td>
                        <td>{% if account.complexity == None %}-{% else %}{{ account.complexity }}{% endif %}</td>
                        <td>{{ account.is_admin }}</td>
                        <td>{{ account.is_kerberoastable }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
</body>
</html>
<script>

    function getURLParameter(name) {
        return new URLSearchParams(window.location.search).get(name);
    }

    $(document).ready(function () {
        var table = $('#passwordTable').DataTable({
            "order": [[ 1, "asc" ]],
            "dom": 'Blfrtip',
            "buttons": [{
                extend: 'colvis',
                text: 'Show/Hide Columns'
            }],
            "pageLength": 100,
            "lengthMenu": [ [10, 25, 50, 100, 500, 1000], [10, 25, 50, 100, 500, 1000] ],
            "columnDefs": [
                { "orderable": false, "targets": [4, 7, 8] }
            ]
        });

        table.buttons().container().appendTo('#colvis-container');

        // Prevent ordering when clicking inside the length filter inputs
        $('#minLength, #maxLength').on('mousedown click', function (e) {
            e.stopPropagation();
        });

        // Custom filtering function for numeric ranges and exact match
        $.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {
            const isCracked = data[4];
            const length = parseFloat(data[5]) || 0;
            const complex = parseFloat(data[6]) || 0;
            const isAdmin = data[7];
            const isKerb = data[8];

            const crackedFilter = $('#crackedFilter').val();
            const minLength = parseFloat($('#minLength').val()) || -Infinity;
            const maxLength = parseFloat($('#maxLength').val()) || Infinity;
            const minComplex = parseFloat($('#minComplex').val()) || -Infinity;
            const maxComplex = parseFloat($('#maxComplex').val()) || Infinity;
            const adminFilter = $('#adminFilter').val();
            const kerbFilter = $('#kerbFilter').val();

            const crackedMatch = !crackedFilter || isCracked === crackedFilter;
            const lengthMatch = length >= minLength && length <= maxLength;
            const complexMatch = complex >= minComplex && complex <= maxComplex;
            const adminMatch = !adminFilter || isAdmin === adminFilter;
            const kerbMatch = !kerbFilter || isKerb === kerbFilter;

            return crackedMatch && lengthMatch && complexMatch && adminMatch && kerbMatch;
        });

        // Trigger redraw on input change
        $('#crackedFilter, #minLength, #maxLength, #minComplex, #maxComplex, #adminFilter, #kerbFilter').on('input change', function () {
            table.draw();
        });

         // Set initial filters from URL
        $('#crackedFilter').val(getURLParameter('is_cracked') || '');
        $('#minLength').val(getURLParameter('minLength') || '');
        $('#maxLength').val(getURLParameter('maxLength') || '');
        $('#minComplex').val(getURLParameter('minComplex') || '');
        $('#maxComplex').val(getURLParameter('maxComplex') || '');
        $('#adminFilter').val(getURLParameter('is_admin') || '');
        $('#kerbFilter').val(getURLParameter('is_kerberoastable') || '');
        table.draw();
    });
</script>